<project name="Milyn Commons Ant build script" default="build">
	<description>Milyn Commons</description>

    <!-- Set the properties. -->
	<property file="build.properties" />
	<property file="classpath.properties" />
    <!-- The version should get set by the release target -->
	<property name="commons.version" value="x.x.x" />

    <!-- Set the classpath. -->
	<path id="build.classpath">
		<pathelement location="${build.root}/classes"/>
		<fileset dir="${build.lib}" includes="*.jar"/>
	</path>

    <!-- TARGETS.... -->

	<target name="build" depends="compile,jar" description="Build Milyn Commons." />

	<target name="compile">
		<mkdir dir="${build.classes}" />
		<javac srcdir="${build.src}" destdir="${build.classes}" debug="on">
			<classpath refid="build.classpath" />
		</javac>
	</target>

	<target name="jar">
		<mkdir dir="${build.lib}" />
        <jar destfile="${build.lib}/milyn-commons-${commons.version}.jar">
			<fileset dir="${build.classes}" excludes="**/*UnitTest.class"/>
			<fileset dir="${build.src}" excludes="**/*.java"/>
		</jar>
    </target>

	<target name="javadoc">
        <property name="javadoc.output" value="${build.docs}/api" />

		<mkdir dir="${javadoc.output}"/>
		<javadoc classpathref="build.classpath" destdir="${javadoc.output}" failonerror="true" >
			<packageset dir="${build.src}" />
            <doctitle>
                <![CDATA[<h1>Milyn-Commons</h1>Version ${commons.version}]]>
            </doctitle>
            <header>
                <![CDATA[Milyn-Commons Version ${commons.version}]]>
            </header>
		</javadoc>
	</target>

	<target name="clean" description="Clean.">
		<delete dir="${build.classes}" />
		<delete file="${build.lib}/milyn-commons-${commons.version}.jar" />
		<delete dir="${build.docs}" />
	</target>

</project>

