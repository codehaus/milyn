<?xml version="1.0"?>
<smooks-resource-list xmlns="http://www.milyn.org/xsd/smooks-1.0.xsd">

    <resource-config selector="order">
        <resource>org.milyn.javabean.BeanPopulator</resource>
        <param name="beanId">order</param>
        <param name="beanClass">java.util.HashMap</param>
        <param name="beforeBindingExpression">
        	order.totalSum = 0;
        </param>
        <param name="afterBindingExpression">
        	order.totalSum += order.deliveryCosts;
        </param>
        <param name="bindings">

			<binding property="deliveryCosts" type="Double" selector="order @deliveryCosts" />

            <binding property="totalSum" selector="orderLine">
            	order.totalSum + orderLine.price * orderLine.amount;
            </binding>

        </param>
    </resource-config>

    <resource-config selector="orderLine">
        <resource>org.milyn.javabean.BeanPopulator</resource>
        <param name="beanId">orderLine</param>
        <param name="beanClass">java.util.HashMap</param>
        <param name="bindings">
            <binding property="price" type="Double" selector="orderLine/price" />
            <binding property="amount" type="Integer" selector="orderLine/amount" />
        </param>
    </resource-config>

</smooks-resource-list>