<?xml version="1.0"?>
<smooks-resource-list xmlns="http://www.milyn.org/xsd/smooks-1.0.xsd">

    <!--
    Configure the History bean creation and population.
    -->
    <resource-config selector="history">
        <resource>org.milyn.javabean.BeanPopulator</resource>
        <param name="beanId">history</param>
        <param name="beanClass">example.model.ShippingHistory</param>
        <param name="bindings">
            <!-- Bindings. Note the "special" decoder for the trackingNumbers - see end of config! -->
            <binding property="creationDate" type="Date" selector="header date" />
            <binding property="trackingNumbers" type="TrackingNumberHistory" selector="history trackingNumbers" />
        </param>
    </resource-config>

    <!--
    Configure the Warehouse bean creation and population.
    Note how we create it on visiting the history element and set the bean on
    history element (will set it based on it's own beanId).
    -->
    <resource-config selector="history">
        <resource>org.milyn.javabean.BeanPopulator</resource>
        <param name="beanId">warehouse</param>
        <param name="setOn">history</param>
        <param name="beanClass">example.model.Warehouse</param>
        <param name="bindings">
            <!-- Bindings. -->
            <binding property="id" type="Integer" selector="history @warehouse" />
        </param>
    </resource-config>

    <!--
    Use a FreeMarker template to perform the model driven transformation.  You can also inline the template here.
    -->
    <resource-config selector="$document">
        <resource>/example/templates/HistoryTrans.ftl</resource>
    </resource-config>

    <!--
    Configure a "special" decoder for trackingNumbers field.
    -->
    <resource-config selector="decoder:TrackingNumberHistory">
        <resource>example.model.TrackingNumberDecoder</resource>
    </resource-config>

</smooks-resource-list>
